webpackJsonp([35],{alcQ:function(e,t,a){"use strict";t.a={data:function(){return{formRefValue$:"form",formLoading:!1}},methods:{resetForm:function(){this.$refs[this.formRefValue$].resetFields()}}}},rRkE:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("3cXf"),o=a.n(r),s=a("qSEq"),i=a("alcQ"),l=a("ELdc"),n=a("GV6u"),u={name:"route-edit",componentName:"RouteEdit",mixins:[s.b,i.a],props:{moduleId:{type:String,required:!0},subModuleId:{type:String,required:!0},data:{type:Object,default:function(){return{}}}},data:function(){var e=this;return{routeViews:[],formData:{},formRules:{name:[{required:!0,message:"请输入路由名称",trigger:"blur"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"}],value:[{required:!0,message:"请输入路由唯一标识符",trigger:"blur"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"},{validator:function(t,a,r){/^[a-zA-Z0-9_]+$/.test(a)?e.$Ajax.get(n.a.get.validateValueCanUseBySubModuleId,[a,e.subModuleId],{params:{moduleId:e.moduleId,excludeValues:e.data.value}}).success(!0,function(e){e.records.canUse?r():r(new Error("路由唯一标识符不可用"))}).fail(!0,function(e){r(new Error(e.resultInfo.message))}).catch(function(){r(new Error("发生错误...请稍后再试"))}):r(new Error("路由唯一标识符格式不正确,只能由字母、数字、下划线组成"))},trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"},{validator:function(t,a,r){e.$Ajax.get(n.a.get.validatePathCanUseBySubModuleId,[e.subModuleId],{params:{moduleId:e.moduleId,path:a,excludePaths:e.data.path}}).success(!0,function(e){e.records.canUse?r():r(new Error("路由地址不可用"))}).fail(!0,function(e){r(new Error(e.resultInfo.message))}).catch(function(){r(new Error("发生错误...请稍后再试"))})},trigger:"blur"}],alias:[{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"},{validator:function(t,a,r){a?e.$Ajax.get(n.a.get.validateAliasCanUseBySubModuleId,[a,e.subModuleId],{params:{moduleId:e.moduleId,excludeAliases:e.data.alias}}).success(!0,function(e){e.records.canUse?r():r(new Error("路由重定向别名不可用"))}).fail(!0,function(e){r(new Error(e.resultInfo.message))}).catch(function(){r(new Error("发生错误...请稍后再试"))}):r()},trigger:"blur"}]}}},watch:{data:function(e){this.resetEditForm()}},methods:{resetEditForm:function(){this.formData=Object(l.a)({},this.data);var e=[];this.data.routeViews&&this.data.routeViews.forEach(function(t){e.push(Object(l.a)({},t))}),this.routeViews=e,this.formData.routeViews=e},submit:function(){var e=this;this.$refs[this.formRefValue$].validate(function(t){if(!t)return!1;for(var a in e.routeViews){if(!e.routeViews[a].value)return void e.$message("命名视图不能为空");for(var r in e.routeViews)if(e.routeViews[a]!==e.routeViews[r]&&e.routeViews[a].value===e.routeViews[r].value)return void e.$message("命名视图不能重复")}e.formLoading=!0,e.$Ajax.put(n.a.put.routeByRouteId,Object(l.a)({moduleId:e.moduleId,subModuleId:e.subModuleId,routeId:e.formData.id,routeViewJson:o()(e.routeViews)},e.formData)).success("修改路由成功",function(){e.$emit("submit-success",e.formData,e)}).finally(function(){return e.formLoading=!1})})}},created:function(){this.resetEditForm()}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-padding-all"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:e.formRefValue$,attrs:{rules:e.formRules,model:e.formData,"label-width":"160px",size:"small"}},[e.formData.parentId?a("el-form-item",{attrs:{label:"父级路由名称："}},[a("el-input",{attrs:{disabled:"",clearable:""},model:{value:e.formData.parentRouteName,callback:function(t){e.$set(e.formData,"parentRouteName",t)},expression:"formData.parentRouteName"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"路由名称：",prop:"name"}},[a("el-input",{attrs:{clearable:""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路由唯一标识符：",prop:"value"}},[a("el-input",{attrs:{clearable:""},model:{value:e.formData.value,callback:function(t){e.$set(e.formData,"value",t)},expression:"formData.value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路由地址：",prop:"path"}},[a("el-input",{attrs:{clearable:""},model:{value:e.formData.path,callback:function(t){e.$set(e.formData,"path",t)},expression:"formData.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"重定向别名：",prop:"alias"}},[a("el-input",{attrs:{clearable:""},model:{value:e.formData.alias,callback:function(t){e.$set(e.formData,"alias",t)},expression:"formData.alias"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"命名视图："}},[a("we-button",{attrs:{size:"small",type:"success"},on:{click:function(t){e.routeViews.push({value:"",props:!1})}}},[e._v("新增视图")]),e._v(" "),e._l(e.routeViews,function(t,r){return[a("div",{staticClass:"gar-form-edit-one"},[a("div",{staticClass:"edit-one-left common-wp-70"},[a("el-input",{staticClass:"common-wp-55 common-float-left",attrs:{size:"small"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"routeView.value"}}),e._v(" "),a("el-checkbox",{staticClass:"common-float-left common-margin-lr-mini",attrs:{"true-label":e.dict.routeViewValue.true,"false-label":e.dict.routeViewValue.false,border:""},model:{value:t.props,callback:function(a){e.$set(t,"props",a)},expression:"routeView.props"}},[e._v("\n              启用props\n            ")]),e._v(" "),a("we-button",{directives:[{name:"show",rawName:"v-show",value:e.routeViews.length>1,expression:"routeViews.length > 1"}],staticClass:"common-float-left",attrs:{size:"small","icon-name":"trash",type:"danger"},on:{click:function(t){e.routeViews.splice(r,1)}}})],1),e._v(" "),a("div",{staticClass:"common-clear"})])]})],2),e._v(" "),a("el-form-item",{attrs:{label:"路由描述：",prop:"description"}},[a("el-input",{attrs:{type:"textarea",rows:10,resize:"none"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{loading:e.formLoading,type:"primary"},on:{click:e.submit}},[e._v("提交修改")]),e._v(" "),a("el-button",{attrs:{disabled:e.formLoading},on:{click:e.resetEditForm}},[e._v("重置")]),e._v(" "),e._t("button")],2)],1)],1)},staticRenderFns:[]},c=a("C7Lr")(u,m,!1,null,null,null);t.default=c.exports}});