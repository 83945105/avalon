webpackJsonp([4,5,7,26],{"+hZp":function(e,t,l){e.exports=l.p+"gar/img/no_authority_img.85ebcdd.png"},"+pQH":function(e,t,l){var o=l("273z");o(o.P+o.R,"Map",{toJSON:l("R+mD")("Map")})},"29J1":function(e,t,l){e.exports=l.p+"gar/img/no_data_img.869b577.png"},"4qZx":function(e,t,l){var o=l("ih9o");e.exports=function(e,t){if(!o(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},BBDL:function(e,t,l){"use strict";var o=l("IHPB"),i=l.n(o),a=l("rVsN"),n=l.n(a),r=l("ELdc"),s=l("C6mD"),d={tableCellEditRef:"tableCellEdit",tableCellEditProps:[],tableCellEditSize:"medium",tableCellEditBlurSaveEdit:!0,tableCellEditChangeSaveEdit:!0,tableCellEditSkeleton:!0,tableCellEditLoading:!1,tableCellEditRows:[],tableCellEditRowDeleteLoading$:"delete_loading$",tableCellEditRowColumnEditSuffix$:"_edit$",tableCellEditRowColumnEditValueSuffix$:"_editValue$",tableCellEditRowColumnEditLoading$:"_edit_loading$",tableCellEditShowAdd:!1,tableCellEditAddLoading:!1,tableCellEditShowEdit:!1,tableCellEditEditLoading:!1,tableCellEditEditRow:{},tableCellEditEditIndex:-1};t.a={props:{reloadTableCellEdit:Function},data:function(){return Object(r.a)({},d)},computed:{tableCellEditCount:function(){var e=this,t=0;return this.tableCellEditRows.forEach(function(l){e.tableCellEditProps.forEach(function(o){!0===l[""+o+e.tableCellEditRowColumnEditSuffix$]&&t++})}),t}},methods:{formatterTableCellEditRow:function(e){var t=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps,o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).formatterCell;return e[this.tableCellEditRowDeleteLoading$]=!1,l.forEach(function(l){e[""+l+t.tableCellEditRowColumnEditSuffix$]=!1,e[""+l+t.tableCellEditRowColumnEditValueSuffix$]=e[l],e[""+l+t.tableCellEditRowColumnEditLoading$]=!1,o&&o(e,l)}),e},formatterTableCellEditRows:function(e){var t=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.formatterRow,a=o.formatterCell;return e.forEach(function(e){i&&i(e),t.formatterTableCellEditRow(e,l,{formatterCell:a})}),e},reloadTableCellEditRows:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=t.formatterRow,o=t.formatterCell;Object(s.f)(this.reloadTableCellEdit)&&(this.tableCellEditLoading=!0,new n.a(this.reloadTableCellEdit).then(function(t){e.tableCellEditLoading=!1,e.tableCellEditSkeleton=!1,e.tableCellEditRows=e.formatterTableCellEditRows(t,e.tableCellEditProps,{formatterRow:l,formatterCell:o})}).catch(function(t){e.tableCellEditLoading=!1,e.tableCellEditSkeleton=500}))},appendTableCellEditRow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps,l=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).formatterCell;this.tableCellEditRows.push(this.formatterTableCellEditRow(e,t,{formatterCell:l}))},appendTableCellEditRows:function(e){var t,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=o.formatterRow,n=o.formatterCell;(t=this.tableCellEditRows).push.apply(t,i()(this.formatterTableCellEditRows(e,l,{formatterRow:a,formatterCell:n})))},removeTableCellEditRow:function(e){if(e)for(var t=0;t<this.tableCellEditRows.length;t++)if(e===this.tableCellEditRows[t])return void this.tableCellEditRows.splice(t,1)},removeTableCellEditRows:function(e){if(e&&0!==e.length)for(var t=0;t<this.tableCellEditRows.length;t++)for(var l in e)if(e[l]===this.tableCellEditRows[t]){this.tableCellEditRows.splice(t,1),t--;break}},handleCloseLoadingTableCellEditRowColumn:function(e,t){e[""+t+this.tableCellEditRowColumnEditLoading$]=!1},handleCloseLoadingTableCellEditRowColumns:function(e){var t=this;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps).forEach(function(l){return t.handleCloseLoadingTableCellEditRowColumn(e,l)})},handleCloseEditAndLoadingTableCellEditRowColumn:function(e,t){e[""+t+this.tableCellEditRowColumnEditSuffix$]=!1,e[""+t+this.tableCellEditRowColumnEditLoading$]=!1},handleCloseEditAndLoadingTableCellEditRowColumns:function(e){var t=this;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps).forEach(function(l){return t.handleCloseEditAndLoadingTableCellEditRowColumn(e,l)})},handleCloseAllEditAndLoadingTableCellEditRowColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tableCellEditProps;this.tableCellEditRows.forEach(function(l){return e.handleCloseEditAndLoadingTableCellEditRowColumns(l,t)})},handleConfirmCloseAllTableCellEdit:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tableCellEditProps;return new n.a(function(l,o){0!==e.tableCellEditCount?e.$confirm({content:"是否取消编辑中的单元格?",onClickConfirmButton:function(o,i){e.handleCloseAllEditAndLoadingTableCellEditRowColumns(t),i.close(),l()}}):l()})},handleOpenTableCellEditRowColumnEdit:function(e,t){-1!==this.tableCellEditProps.indexOf(t)&&(e[""+t+this.tableCellEditRowColumnEditSuffix$]=!0)},handleOpenTableCellEditRowColumnsEdit:function(e){var t=this;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps).forEach(function(l){return t.handleOpenTableCellEditRowColumnEdit(e,l)})},handleOpenTableCellEditRowColumnLoading:function(e,t){e[""+t+this.tableCellEditRowColumnEditLoading$]=!0},handleOpenTableCellEditRowColumnsLoading:function(e){var t=this;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps).forEach(function(l){return t.handleOpenTableCellEditRowColumnLoading(e,l)})},isTableCellEditRowColumnChange:function(e,t){return e[""+t+this.tableCellEditRowColumnEditValueSuffix$]!==e[t]},isTableCellEditRowChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps;for(var l in t)if(this.isTableCellEditRowColumnChange(e,t[l]))return!0;return!1},getTableCellEditChangeRowColumnNewValues:function(e){var t=this,l={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps).forEach(function(o){t.isTableCellEditRowColumnChange(e,o)&&(l[o]=e[""+o+t.tableCellEditRowColumnEditValueSuffix$])}),l},restoreTableCellEditChangeRowColumnValue:function(e,t){this.isTableCellEditRowColumnChange(e,t)&&(e[""+t+this.tableCellEditRowColumnEditValueSuffix$]=e[t])},restoreTableCellEditChangeRowColumnsValue:function(e){var t=this;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps).forEach(function(l){return t.restoreTableCellEditChangeRowColumnValue(e,l)})},restoreTableCellEditChangeRowColumnValueAndCloseEdit:function(e,t){this.isTableCellEditRowColumnChange(e,t)&&(e[""+t+this.tableCellEditRowColumnEditValueSuffix$]=e[t]),e[""+t+this.tableCellEditRowColumnEditSuffix$]=!1},restoreTableCellEditChangeRowColumnsValueAndCloseEdit:function(e){var t=this;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps).forEach(function(l){return t.restoreTableCellEditChangeRowColumnValueAndCloseEdit(e,l)})},syncTableCellEditRowColumnEditValue:function(e,t){this.isTableCellEditRowColumnChange(e,t)&&(e[t]=e[""+t+this.tableCellEditRowColumnEditValueSuffix$])},syncTableCellEditRowColumnsEditValue:function(e){var t=this;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps).forEach(function(l){return t.syncTableCellEditRowColumnEditValue(e,l)})},handleBlurTableCellEditColumnChange:function(e){this.tableCellEditBlurSaveEdit&&(this.isTableCellEditRowColumnChange(e.row,e.column.property)?this.handleSaveTableCellEdit(e):this.restoreTableCellEditChangeRowColumnValueAndCloseEdit(e.row,e.column.property))},isEnableTableCellEditConfirmEditRow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps;for(var l in t){if(e.row[""+t[l]+this.tableCellEditRowColumnEditLoading$])return!1;if(!e.row[""+t[l]+this.tableCellEditRowColumnEditSuffix$])return!0}return!1},isEnableTableCellEditCancelEditRow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps;for(var l in t){if(e.row[""+t[l]+this.tableCellEditRowColumnEditLoading$])return!1;if(e.row[""+t[l]+this.tableCellEditRowColumnEditSuffix$])return!0}return!1},isEnableTableCellEditSaveEditRow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps;for(var l in t){if(e.row[""+t[l]+this.tableCellEditRowColumnEditLoading$])return!1;if(e.row[""+t[l]+this.tableCellEditRowColumnEditSuffix$]&&this.isTableCellEditRowColumnChange(e.row,t[l]))return!0}return!1}}}},CVdf:function(e,t,l){var o=l("GEwK"),i=l("bPMW"),a=l("6Ke0"),n=l("WA9S"),r=l("GO8T");e.exports=function(e,t){var l=1==e,s=2==e,d=3==e,c=4==e,u=6==e,h=5==e||u,p=t||r;return function(t,r,f){for(var C,m,g=a(t),b=i(g),v=o(r,f,3),E=n(b.length),w=0,R=l?p(t,E):s?p(t,0):void 0;E>w;w++)if((h||w in b)&&(m=v(C=b[w],w,g),e))if(l)R[w]=m;else if(m)switch(e){case 3:return!0;case 5:return C;case 6:return w;case 2:R.push(C)}else if(c)return!1;return u?-1:d||c?c:R}}},GO8T:function(e,t,l){var o=l("oeSC");e.exports=function(e,t){return new(o(e))(t)}},HzJ8:function(e,t,l){e.exports={default:l("UCoN"),__esModule:!0}},Kdj8:function(e,t,l){"use strict";var o=l("HH4H"),i=l("273z"),a=l("92Lf"),n=l("QzFD"),r=l("Rb18"),s=l("SFw5"),d=l("EWZD"),c=l("6Iqy"),u=l("ih9o"),h=l("bNZV"),p=l("VKnT").f,f=l("CVdf")(0),C=l("5D1g");e.exports=function(e,t,l,m,g,b){var v=o[e],E=v,w=g?"set":"add",R=E&&E.prototype,y={};return C&&"function"==typeof E&&(b||R.forEach&&!n(function(){(new E).entries().next()}))?(E=t(function(t,l){c(t,E,e,"_c"),t._c=new v,void 0!=l&&d(l,g,t[w],t)}),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in R&&(!b||"clear"!=e)&&r(E.prototype,e,function(l,o){if(c(this,E,e),!t&&b&&!u(l))return"get"==e&&void 0;var i=this._c[e](0===l?0:l,o);return t?this:i})}),b||p(E.prototype,"size",{get:function(){return this._c.size}})):(E=m.getConstructor(t,e,g,w),s(E.prototype,l),a.NEED=!0),h(E,e),y[e]=E,i(i.G+i.W+i.F,y),b||m.setStrong(E,e,g),E}},Kgiw:function(e,t,l){e.exports=l.p+"gar/img/no_page_img.cccfdce.png"},NnAP:function(e,t,l){var o=l("6Bon"),i=l("MGMR");e.exports=l("UB+n").getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return o(t.call(e))}},OEoC:function(e,t){},OKrO:function(e,t,l){l("uT9G")("Map")},PdGq:function(e,t){},"R+mD":function(e,t,l){var o=l("jUE6"),i=l("c5rS");e.exports=function(e){return function(){if(o(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},SHIm:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=l("p00s"),i=l.n(o),a=l("qSEq"),n=l("BBDL"),r=l("ELdc"),s=l("sZfY"),d=l("vqdg"),c=l("elhn"),u=l("px6D"),h=l("qgjB"),p=(a.b.data(),{currentPage:1,pageSizes:[10,20,50,100],total:0,pageCount:1}),f={likeText:""},C={components:{RoleAdd:h.default,ErrorPage:c.a,RoleResourceManager:d.default,RoleUserManager:s.default},name:"role-manage",mixins:[a.b,n.a],props:{moduleId:{type:String,required:!0}},data:function(){return{limit:Object(r.a)({pageSize:20},p),params:Object(r.a)({},f),tableCellEditProps:["name","type"],tableCellEditSize:"medium",tableCellEditBlurSaveEdit:!1,tableCellEditChangeSaveEdit:!0,checkedRoleList:[],deleteRoleLoading:!1}},methods:{reGetTableCellEditRows:function(){Object(r.a)(this.limit,p),this.getTableCellEditRows()},getTableCellEditRows:function(){var e=this;this.tableCellEditLoading=!0,this.$Ajax.get(u.a.get.pageListRole,Object(r.a)({moduleId:this.moduleId},this.limit,this.params)).success(!0,function(t){e.tableCellEditSkeleton=!1,e.tableCellEditRows=e.formatterTableCellEditRows(t.rows,e.tableCellEditProps),Object(r.a)(e.limit,t.limit)}).notSuccess(function(){return e.tableCellEditSkeleton=500}).catch(function(){return e.tableCellEditSkeleton=500}).finally(function(){return e.tableCellEditLoading=!1})},handleSaveTableCellEdit:function(e){var t=this,l=e.row,o=e.column,a=(e.$index,this.getTableCellEditChangeRowColumnNewValues(l,[o.property])),n=i()(a);this.handleCloseEditAndLoadingTableCellEditRowColumn(l,o.property),0!==n.length&&(this.handleOpenTableCellEditRowColumnsLoading(l,n),this.$Ajax.put(u.a.put.roleByRoleId,Object(r.a)({moduleId:this.moduleId,roleId:l.id},a)).success(!0,function(){t.syncTableCellEditRowColumnEditValue(l,o.property)}).finally(function(){return t.handleCloseLoadingTableCellEditRowColumn(l,o.property)}))},handleSaveTableRowEdit:function(e){var t=this,l=e.row,o=(e.column,e.$index,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tableCellEditProps),a=this.getTableCellEditChangeRowColumnNewValues(l,o),n=i()(a);this.handleCloseEditAndLoadingTableCellEditRowColumns(l,o),0!==n.length&&(this.handleOpenTableCellEditRowColumnsLoading(l,n),this.$Ajax.put(u.a.put.roleByRoleId,Object(r.a)({moduleId:this.moduleId,roleId:l.id},a)).success(!0,function(){t.syncTableCellEditRowColumnsEditValue(l,n)}).finally(function(){return t.handleCloseLoadingTableCellEditRowColumns(l,o)}))},handleChangeStatus:function(e){var t=this,l=e.row;e.column,e.$index;this.$Ajax.put(u.a.put.roleByRoleId,{moduleId:this.moduleId,roleId:l.id,status:l.status}).success(!0).notSuccess(function(){return l.status=l.status===t.dict.statusValue.NORMAL?t.dict.statusValue.DISABLED:t.dict.statusValue.NORMAL})},handleDeleteRow:function(e,t,l){var o=this,i=l.row,a=(l.column,l.$index);i[this.tableCellEditRowDeleteLoading$]=!0,this.$Ajax.delete(u.a.delete.roleByRoleId,{moduleId:this.moduleId,roleId:i.id}).before(function(){return i[o.tableCellEditRowDeleteLoading$]=!1}).success("删除成功",function(){o.tableCellEditRows.splice(a,1),t.close()})},handleClickDeleteCheckedRoles:function(){},handleSubmitSuccess:function(e,t){this.tableCellEditRows.push(this.formatterTableCellEditRow(e,this.tableCellEditProps))}},created:function(){this.getTableCellEditRows()}},m={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("div",{staticClass:"gar-search-bar"},[l("ul",{staticClass:"gar-search-bar-list"},[l("li",[l("em",{staticClass:"list-left"},[e._v("关键字：")]),e._v(" "),l("div",{staticClass:"list-right common-w-large"},[l("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入关键字"},model:{value:e.params.likeText,callback:function(t){e.$set(e.params,"likeText",t)},expression:"params.likeText"}})],1)]),e._v(" "),l("li",{staticClass:"spacing"},[l("we-button",{attrs:{loading:e.tableCellEditLoading,clearable:"",size:"small"},on:{click:function(t){e.handleConfirmCloseAllTableCellEdit().then(e.reGetTableCellEditRows)}}},[e._v("查询\n        ")])],1)]),e._v(" "),l("div",{staticClass:"common-float-right"},[l("we-button",{attrs:{size:"small",type:"success"},on:{click:function(t){e.handleConfirmCloseAllTableCellEdit().then(function(){return e.tableCellEditShowAdd=!0})}}},[e._v("新增角色\n      ")])],1),e._v(" "),l("div",{staticClass:"common-clear"})]),e._v(" "),l("div",{staticClass:"gar-tools-bar"},[l("we-button",{attrs:{type:"text",disabled:0===e.checkedRoleList.length,loading:e.deleteRoleLoading},on:{click:e.handleClickDeleteCheckedRoles}},[e._v("删除角色\n    ")]),e._v(" "),l("we-button",{attrs:{type:"text",disabled:0===e.tableCellEditCount},on:{click:function(t){e.handleCloseAllEditAndLoadingTableCellEditRowColumns(e.tableCellEditProps)}}},[e._v("取消所有编辑\n    ")])],1),e._v(" "),l("div",{staticClass:"gar-list-main",staticStyle:{top:"99px"}},[l("we-skeleton",{attrs:{animation:"","paragraph-rows":10,"paragraph-width":"100%"},on:{reload:e.getTableCellEditRows},model:{value:e.tableCellEditSkeleton,callback:function(t){e.tableCellEditSkeleton=t},expression:"tableCellEditSkeleton"}},[l("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tableCellEditLoading&&!1===e.tableCellEditSkeleton,expression:"tableCellEditLoading && tableCellEditSkeleton === false"}],staticClass:"gar-list-main-inner",staticStyle:{bottom:"62px"}},[l("el-table",{attrs:{data:e.tableCellEditRows,size:e.tableCellEditSize,fit:"",height:"100%"},on:{"cell-dblclick":function(t,l,o,i){return e.handleOpenTableCellEditRowColumnEdit(t,l.property)}}},[l("template",{slot:"empty"},[l("error-page",{attrs:{"image-width":180,"image-height":180}})],1),e._v(" "),l("el-table-column",{attrs:{type:"selection",width:"40"}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"角色名称",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",{directives:[{name:"loading",rawName:"v-loading",value:{value:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$],size:"mini"},expression:"{\n                value: scope.row[`${scope.column.property}${tableCellEditRowColumnEditLoading$}`],\n                size: 'mini'\n              }"}]},[!t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$]&&t.row[""+t.column.property+e.tableCellEditRowColumnEditSuffix$]?[l("we-tooltip",{attrs:{disabled:e.tableCellEditBlurSaveEdit,placement:"top-start",effect:"light"}},[l("template",{slot:"content"},[l("we-button",{attrs:{disabled:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$],type:"text",size:"mini"},on:{click:function(l){e.restoreTableCellEditChangeRowColumnValueAndCloseEdit(t.row,t.column.property)}}},[e._v("关闭")]),e._v(" "),l("we-button",{attrs:{disabled:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$]||!e.isTableCellEditRowColumnChange(t.row,t.column.property),size:"mini"},on:{click:function(l){e.restoreTableCellEditChangeRowColumnValue(t.row,t.column.property)}}},[e._v("还原")]),e._v(" "),l("we-button",{attrs:{loading:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$],disabled:!e.isTableCellEditRowColumnChange(t.row,t.column.property),type:"primary",size:"mini"},on:{click:function(l){e.handleSaveTableCellEdit(t)}}},[e._v("保存")])],1),e._v(" "),l("el-input",{attrs:{placeholder:"请输入"+t.column.label,size:e.tableCellEditSize},on:{blur:function(l){e.handleBlurTableCellEditColumnChange(t)}},model:{value:t.row[""+t.column.property+e.tableCellEditRowColumnEditValueSuffix$],callback:function(l){e.$set(t.row,""+t.column.property+e.tableCellEditRowColumnEditValueSuffix$,l)},expression:"scope.row[`${scope.column.property}${tableCellEditRowColumnEditValueSuffix$}`]"}})],2)]:[e._v(e._s(t.row[t.column.property]))]],2)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"value",label:"角色标识符",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",{directives:[{name:"loading",rawName:"v-loading",value:{value:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$],size:"mini"},expression:"{\n              value: scope.row[`${scope.column.property}${tableCellEditRowColumnEditLoading$}`],\n              size: 'mini'\n            }"}]},[!t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$]&&t.row[""+t.column.property+e.tableCellEditRowColumnEditSuffix$]?[l("we-tooltip",{attrs:{disabled:e.tableCellEditBlurSaveEdit,placement:"top-start",effect:"light"}},[l("template",{slot:"content"},[l("we-button",{attrs:{disabled:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$],type:"text",size:"mini"},on:{click:function(l){e.restoreTableCellEditChangeRowColumnValueAndCloseEdit(t.row,t.column.property)}}},[e._v("关闭")]),e._v(" "),l("we-button",{attrs:{disabled:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$]||!e.isTableCellEditRowColumnChange(t.row,t.column.property),size:"mini"},on:{click:function(l){e.restoreTableCellEditChangeRowColumnValue(t.row,t.column.property)}}},[e._v("还原")]),e._v(" "),l("we-button",{attrs:{loading:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$],disabled:!e.isTableCellEditRowColumnChange(t.row,t.column.property),type:"primary",size:"mini"},on:{click:function(l){e.handleSaveTableCellEdit(t)}}},[e._v("保存")])],1),e._v(" "),l("el-input",{attrs:{placeholder:"请输入"+t.column.label,size:e.tableCellEditSize},on:{blur:function(l){e.handleBlurTableCellEditColumnChange(t)}},model:{value:t.row[""+t.column.property+e.tableCellEditRowColumnEditValueSuffix$],callback:function(l){e.$set(t.row,""+t.column.property+e.tableCellEditRowColumnEditValueSuffix$,l)},expression:"scope.row[`${scope.column.property}${tableCellEditRowColumnEditValueSuffix$}`]"}})],2)]:[e._v(e._s(t.row[t.column.property]))]],2)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"type",label:"角色类型",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",{directives:[{name:"loading",rawName:"v-loading",value:{value:t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$],size:"mini"},expression:"{\n                value: scope.row[`${scope.column.property}${tableCellEditRowColumnEditLoading$}`],\n                size: 'mini'\n              }"}]},[!t.row[""+t.column.property+e.tableCellEditRowColumnEditLoading$]&&t.row[""+t.column.property+e.tableCellEditRowColumnEditSuffix$]?[l("el-select",{attrs:{placeholder:"请选择"+t.column.label,size:e.tableCellEditSize},on:{change:function(){!0===e.tableCellEditChangeSaveEdit&&e.handleSaveTableCellEdit(t)}},model:{value:t.row[""+t.column.property+e.tableCellEditRowColumnEditValueSuffix$],callback:function(l){e.$set(t.row,""+t.column.property+e.tableCellEditRowColumnEditValueSuffix$,l)},expression:"scope.row[`${scope.column.property}${tableCellEditRowColumnEditValueSuffix$}`]"}},e._l(e.dict.roleTypes,function(e,t){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)]:[e._v(e._s(e.dict.roleTypeLabel[t.row[t.column.property]]))]],2)]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.type===e.dict.resourceTypeValue.NODE?[e._v("-")]:l("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#cccccc","active-value":e.dict.statusValue.NORMAL,"inactive-value":e.dict.statusValue.DISABLED},on:{change:function(l){e.handleChangeStatus(t)}},model:{value:t.row.status,callback:function(l){e.$set(t.row,"status",l)},expression:"scope.row.status"}})]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"status",label:"操作",align:"center",width:"270","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",size:"mini",disabled:!e.isEnableTableCellEditConfirmEditRow(t,e.tableCellEditProps)},on:{click:function(l){e.handleOpenTableCellEditRowColumnsEdit(t.row,e.tableCellEditProps)}}},[e._v("\n                编辑此行\n              ")]),e._v(" "),l("el-button",{attrs:{type:"text",size:"mini",disabled:!e.isEnableTableCellEditCancelEditRow(t,e.tableCellEditProps)},on:{click:function(l){e.handleCloseEditAndLoadingTableCellEditRowColumns(t.row,e.tableCellEditProps)}}},[e._v("\n                取消编辑此行\n              ")]),e._v(" "),l("el-button",{attrs:{type:"text",size:"mini",disabled:!e.isEnableTableCellEditSaveEditRow(t,e.tableCellEditProps)},on:{click:function(l){e.handleSaveTableRowEdit(t,e.tableCellEditProps)}}},[e._v("\n                保存此行\n              ")]),e._v(" "),l("we-popover",{attrs:{title:"操作",type:"confirm",placement:"top-start",manual:t.row[e.tableCellEditRowDeleteLoading$],"confirm-button-text":"删了吧","cancel-button-text":t.row[e.tableCellEditRowDeleteLoading$]?"你没有想的机会了":"我再想想","cancel-button-options":{disabled:t.row[e.tableCellEditRowDeleteLoading$]},"confirm-button-options":{loading:t.row[e.tableCellEditRowDeleteLoading$]}},on:{"click-cancel-button":function(e,t){return t.close()},"click-confirm-button":function(l,o){return e.handleDeleteRow(l,o,t)}}},[l("template",{slot:"content"},[t.row[e.tableCellEditRowDeleteLoading$]?[l("span",{staticStyle:{color:"red"}},[e._v("删除中...")]),e._v("删除完成后将自动关闭气泡\n                  ")]:[e._v("\n                    您确定要"),l("span",{staticStyle:{color:"red"}},[e._v("删除")]),e._v("该角色"),l("span",{staticStyle:{color:"red"}},[e._v("及相关数据")]),e._v("吗？\n                    "),l("div",{staticStyle:{color:"red"}},[e._v("删除后不可恢复！！！")])]],2),e._v(" "),l("el-button",{attrs:{type:"text",size:"small"}},[e._v("删除")])],2)]}}])})],2)],1)])],1),e._v(" "),l("div",{staticClass:"gar-list-main-paging gar-paging"},[l("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","current-page":e.limit.currentPage,"page-size":e.limit.pageSize,total:e.limit.total,"page-count":e.limit.pageCount,"page-sizes":e.limit.pageSizes},on:{"current-change":function(t){e.limit.currentPage=t,e.getTableCellEditRows()},"size-change":function(t){e.limit.pageSize=t,e.getTableCellEditRows()}}})],1),e._v(" "),l("we-layer",{attrs:{title:"新建角色",width:50,height:60,"min-width":500,"show-footer":!1,drag:"",resize:""},model:{value:e.tableCellEditShowAdd,callback:function(t){e.tableCellEditShowAdd=t},expression:"tableCellEditShowAdd"}},[l("role-add",{attrs:{"module-id":e.moduleId},on:{"submit-success":e.handleSubmitSuccess}},[l("template",{slot:"button"},[l("el-button",{on:{click:function(t){e.tableCellEditShowAdd=!1}}},[e._v("关闭")])],1)],2)],1)],1)},staticRenderFns:[]},g=l("C7Lr")(C,m,!1,null,null,null);t.default=g.exports},UCoN:function(e,t,l){l("xsjh"),l("zRHv"),e.exports=l("NnAP")},aUxz:function(e,t,l){"use strict";var o=l("273z"),i=l("HeGE"),a=l("GEwK"),n=l("EWZD");e.exports=function(e){o(o.S,e,{from:function(e){var t,l,o,r,s=arguments[1];return i(this),(t=void 0!==s)&&i(s),void 0==e?new this:(l=[],t?(o=0,r=a(s,arguments[2],2),n(e,!1,function(e){l.push(r(e,o++))})):n(e,!1,l.push,l),new this(l))}})}},alcQ:function(e,t,l){"use strict";t.a={data:function(){return{formRefValue$:"form",formLoading:!1}},methods:{resetForm:function(){this.$refs[this.formRefValue$].resetFields()}}}},c5rS:function(e,t,l){var o=l("EWZD");e.exports=function(e,t){var l=[];return o(e,!1,l.push,l,t),l}},cUn4:function(e,t,l){e.exports={default:l("p0nO"),__esModule:!0}},elhn:function(e,t,l){"use strict";var o={name:"error-page",componentName:"ErrorPage",optionName:"errorPage",props:{type:{type:[String,Number],default:"noData"},title:String,imageWidth:{type:Number,default:200},imageHeight:{type:Number,default:200}},computed:{__title__:function(){return this.title?this.title:403===this.type||"403"===this.type?"抱歉您无权查看此页面。":404===this.type||"404"===this.type?"抱歉，您访问的页面不存在。":500===this.type||"500"===this.type?"抱歉，您的网络有问题加载失败。":"抱歉暂无信息。"}}},i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"global-no-data"},[e._t("default",[403===e.type||"403"===e.type?o("img",{staticClass:"global-no-data-picture",style:{height:e.imageHeight+"px",width:e.imageWidth+"px"},attrs:{src:l("+hZp")}}):404===e.type||"404"===e.type?o("img",{staticClass:"global-no-data-picture",style:{height:e.imageHeight+"px",width:e.imageWidth+"px"},attrs:{src:l("29J1")}}):500===e.type||"500"===e.type?o("img",{staticClass:"global-no-data-picture",style:{height:e.imageHeight+"px",width:e.imageWidth+"px"},attrs:{src:l("Kgiw")}}):o("img",{staticClass:"global-no-data-picture",style:{height:e.imageHeight+"px",width:e.imageWidth+"px"},attrs:{src:l("29J1")}})]),e._v(" "),o("div",{staticClass:"global-no-data-text",class:{"is-margin-top":0!==e.imageWidth&&0!==e.imageHeight}},[e._t("title",[o("span",[e._v(e._s(e.__title__))])])],2),e._v(" "),o("div",{staticClass:"global-no-data-button"},[e._t("footer")],2)],2)},staticRenderFns:[]},a=l("C7Lr")(o,i,!1,null,null,null);t.a=a.exports},g12w:function(e,t,l){"use strict";var o=l("w12C"),i=l("4qZx");e.exports=l("Kdj8")("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=o.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return o.def(i(this,"Map"),0===e?0:e,t)}},o,!0)},oeSC:function(e,t,l){var o=l("ih9o"),i=l("f5Gq"),a=l("mhb3")("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),o(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},p0nO:function(e,t,l){l("VE3R"),l("zRHv"),l("xsjh"),l("g12w"),l("+pQH"),l("OKrO"),l("tOwx"),e.exports=l("UB+n").Map},pFvh:function(e,t){},px6D:function(e,t,l){"use strict";var o=l("Nj3f"),i={get:{validateValueCanUse:o.a+"/api-gar-role/get/validateValueCanUse/{value}",pageListRole:o.a+"/api-gar-role/get/pageList/role",listRole:o.a+"/api-gar-role/get/list/role"},post:{role:o.a+"/api-gar-role/post/role"},put:{roleByRoleId:o.a+"/api-gar-role/put/roleByRoleId/{roleId}"},delete:{roleByRoleId:o.a+"/api-gar-role/delete/roleByRoleId/{roleId}",listRoleByRoleIds:o.a+"/api-gar-role/delete/list/roleByRoleIds/{roleIds}"}};t.a=i},qgjB:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=l("qSEq"),i=l("alcQ"),a=l("ELdc"),n=l("px6D"),r=o.b.data(),s={name:"",value:"",type:"",description:"",permission:""},d={name:"role-add",mixins:[o.b,i.a],props:{moduleId:{type:String,required:!0}},data:function(){var e=this;return{rolePrefix:this.moduleId+"_",formData:Object(a.a)({},s,{type:r.dict.roleTypeValue.LOCAL,status:r.dict.statusValue.NORMAL}),formRules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],value:[{required:!0,message:"请输入角色唯一标识符",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"},{validator:function(t,l,o){e.$Ajax.post(n.a.get.validateValueCanUse,{value:""+e.rolePrefix+l,moduleId:e.moduleId}).success(!0,function(e){e.records.canUse?o():o(new Error("角色唯一标识符不可用"))}).fail(!0,function(e){o(new Error(e.resultInfo.message))}).catch(function(){o(new Error("发生错误...请稍后再试"))})},trigger:"blur"}],type:[{required:!0,message:"请选择资源类型",trigger:"change"}]}}},methods:{submit:function(){var e=this;this.$refs[this.formRefValue$].validate(function(t){if(t){e.formLoading=!0;var l=Object(a.a)({moduleId:e.moduleId},e.formData,{value:""+e.rolePrefix+e.formData.value});e.$Ajax.post(n.a.post.role,l).success("新建角色成功",function(t){e.resetForm(),e.$emit("submit-success",t.records.role,e)}).finally(function(){return e.formLoading=!1})}})}}},c={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"common-padding-all"},[l("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:e.formRefValue$,attrs:{model:e.formData,rules:e.formRules,"label-width":"100px",size:"small"}},[l("el-form-item",{attrs:{label:"角色名称：",prop:"name"}},[l("el-input",{attrs:{placeholder:"请输入角色名称",size:"small"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"角色标识符：",prop:"value"}},[l("el-input",{staticStyle:{width:"30%"},attrs:{size:"small",disabled:""},model:{value:e.rolePrefix,callback:function(t){e.rolePrefix=t},expression:"rolePrefix"}}),e._v(" "),l("el-input",{staticStyle:{width:"69%",float:"right"},attrs:{placeholder:"请输入角色标识符",size:"small"},model:{value:e.formData.value,callback:function(t){e.$set(e.formData,"value",t)},expression:"formData.value"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"角色类型：",prop:"type"}},[l("el-select",{attrs:{placeholder:"请选择角色类型",size:"small"},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},e._l(e.dict.roleTypes,function(e,t){return l("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"角色描述：",prop:"description"}},[l("el-input",{attrs:{type:"textarea",rows:10,resize:"none"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"立即使用：",prop:"status"}},[l("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#cccccc","active-value":e.dict.statusValue.NORMAL,"inactive-value":e.dict.statusValue.DISABLED},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}})],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{loading:e.formLoading,type:"primary"},on:{click:e.submit}},[e._v("立即创建")]),e._v(" "),l("el-button",{attrs:{disabled:e.formLoading},on:{click:e.resetForm}},[e._v("重置")]),e._v(" "),e._t("button")],2)],1)],1)},staticRenderFns:[]};var u=l("C7Lr")(d,c,!1,function(e){l("PdGq")},"data-v-79b5a9dc",null);t.default=u.exports},sZfY:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=l("HzJ8"),i=l.n(o),a=l("cUn4"),n=l.n(a),r=l("aA9S"),s=l.n(r),d=l("qSEq"),c=l("elhn"),u={currentPage:1,pageCount:1,pageSize:10,total:0},h={name:"object-role-manage",mixins:[d.b],components:{ErrorPage:c.a},data:function(){return{tableHeight:0,userColumnList:[],searchUser:{searchText:""},tableSkeleton:!1,tableLoading:!1,userList:[],limit:s()({},u),checkedUserList:[],roleUserList:[]}},props:{moduleId:{type:String,required:!0},roleId:{type:String,required:!0},role:{type:String,required:!0},roleName:{type:String,required:!0}},computed:{hasUserIdsMap:function(){var e=new n.a,t=!0,l=!1,o=void 0;try{for(var a,r=i()(this.roleUserList);!(t=(a=r.next()).done);t=!0){var s=a.value;e.set(s.userId,!0)}}catch(e){l=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(l)throw o}}return e},disabledUserIdsMap:function(){var e=new n.a,t=!0,l=!1,o=void 0;try{for(var a,r=i()(this.roleUserList);!(t=(a=r.next()).done);t=!0){var s=a.value;"OTHER"===s.type&&e.set(s.userId,!0)}}catch(e){l=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(l)throw o}}return e}},methods:{getUserColumnList:function(){var e=this;this.$Ajax.get(UserManagerUrl.get.userColumnList).success(!0,function(t){e.userColumnList=t.rows,e.getUserPageList()})},reGetUserPageList:function(){s()(this.limit,u),this.getUserPageList()},userListProcess:function(e){var t=this.hasUserIdsMap,l=this.disabledUserIdsMap;for(var o in e)e[o].checked=!!t.get(e[o].id),e[o].disabled=!!l.get(e[o].id);return e},getUserPageList:function(){var e=this;this.tableLoading=!0,this.$Ajax.get(UserManagerUrl.get.userPageList,{moduleId:this.moduleId,currentPage:this.limit.currentPage,pageSize:this.limit.pageSize,searchText:this.searchUser.searchText}).success(!0,function(t){e.tableSkeleton=!1,s()(e.limit,t.limit),e.userList=e.userListProcess(t.rows)}).notSuccess(function(){return e.tableSkeleton=500}).catch(function(){return e.tableSkeleton=500}).finally(function(){return e.tableLoading=!1})},handleSelectionChange:function(e){this.checkedUserList=e},handleSizeChange:function(e){this.limit.pageSize=e,this.getUserPageList()},handleCurrentChange:function(e){this.limit.currentPage=e,this.getUserPageList()},getRoleUserListByRoleId:function(){var e=this;this.$Ajax.get(RoleUserManagerUrl.get.roleUserListByRoleId,[this.roleId],{params:{moduleId:this.moduleId}}).success(!0,function(t){e.roleUserList=t.rows,e.getUserColumnList()})},handleChangeUserRoleCheck:function(e,t){t?this.$Ajax.post(RoleUserManagerUrl.post.grantRoleToUser,{moduleId:this.moduleId,roleId:this.roleId,userId:e.id}).success("授予角色成功").notSuccess(function(){return e.checked=!t}):this.$Ajax.post(RoleUserManagerUrl.post.unGrantRoleToUser,{moduleId:this.moduleId,roleId:this.roleId,userId:e.id}).success("取消角色成功").notSuccess(function(){return e.checked=!t})}},created:function(){this.getRoleUserListByRoleId()},mounted:function(){this.tableHeight=document.body.clientHeight-265}},p={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("div",{staticClass:"gar-search-bar"},[l("ul",{staticClass:"gar-search-bar-list"},[l("li",[l("em",{staticClass:"list-left"},[e._v("关键字：")]),e._v(" "),l("div",{staticClass:"list-right common-w-large"},[l("el-input",{attrs:{size:"small",placeholder:"请输入关键字",clearable:""},model:{value:e.searchUser.searchText,callback:function(t){e.$set(e.searchUser,"searchText",t)},expression:"searchUser.searchText"}})],1)]),e._v(" "),l("li",{staticClass:"spacing"},[l("we-button",{attrs:{loading:e.loading,size:"small"},on:{click:e.reGetUserPageList}},[e._v("查询")])],1)]),e._v(" "),l("div",{staticClass:"common-clear"})]),e._v(" "),l("div",{staticClass:"gar-list-main",staticStyle:{top:"62px"}},[l("we-skeleton",{attrs:{animation:"","paragraph-rows":10,"title-width":"50%","paragraph-width":"100%"},on:{reload:e.getUserPageList},model:{value:e.tableSkeleton,callback:function(t){e.tableSkeleton=t},expression:"tableSkeleton"}},[l("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.tableSkeleton&&e.tableLoading,expression:"!tableSkeleton && tableLoading"}],staticClass:"gar-list-main-inner",staticStyle:{bottom:"62px"}},[l("el-table",{attrs:{data:e.userList,size:"medium",width:"100%",height:"100%"},on:{"selection-change":e.handleSelectionChange}},[l("template",{slot:"empty"},[l("error-page",{attrs:{"image-width":180,"image-height":180}})],1),e._v(" "),e._l(e.userColumnList,function(e,t){return[l("el-table-column",{attrs:{label:e.label,"column-key":e.columnKey,prop:e.columnKey,"min-width":e.minWidth,align:e.align}})]}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"200",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"active-text":"授予","inactive-text":"取消","active-color":"#13ce66","inactive-color":"#cccccc",disabled:t.row.disabled},on:{change:function(l){e.handleChangeUserRoleCheck(t.row,l)}},model:{value:t.row.checked,callback:function(l){e.$set(t.row,"checked",l)},expression:"scope.row.checked"}})]}}])})],2)],1)]),e._v(" "),l("div",{staticClass:"gar-list-main-paging gar-paging"},[l("el-pagination",{attrs:{"current-page":e.limit.currentPage,"page-sizes":[10,50,100,200,300,400],"page-size":e.limit.pageSize,total:e.limit.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},staticRenderFns:[]};var f=l("C7Lr")(h,p,!1,function(e){l("OEoC")},"data-v-51eb9269",null);t.default=f.exports},tOwx:function(e,t,l){l("aUxz")("Map")},uT9G:function(e,t,l){"use strict";var o=l("273z");e.exports=function(e){o(o.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},vqdg:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=l("cUn4"),i=l.n(o),a=l("HzJ8"),n=l.n(a),r=l("aA9S"),s=l.n(r),d=l("qSEq"),c=d.b.data(),u={currentPage:1,pageCount:1,pageSize:10,total:0},h={name:"role-resource-manage",mixins:[d.b],data:function(){return{tableHeight:0,roleResourceList:[],searchType:c.dict.searchTypes[0].value,searchResourceTreeLoading:!1,searchResourceTree:{searchTreeText:""},searchLocationResource:"",searchLocationExpandIds:[],searchResourceTreeList:[],resourceList:[],limit:s()({},u),searchResource:{searchText:""},searchResourceTreeModel:!1}},props:{moduleId:{type:String,required:!0},roleId:{type:String,required:!0},role:{type:String,required:!0},roleName:{type:String,required:!0}},computed:{treeTopNum:function(){return this.searchResourceTreeList.length>0?113:62},searchResourceTreeRootIds:function(){var e=[],t=!0,l=!1,o=void 0;try{for(var i,a=n()(this.searchResourceTreeList);!(t=(i=a.next()).done);t=!0){var r=i.value;e.push(r.id)}}catch(e){l=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(l)throw o}}return e},hasResourceIdsMap:function(){var e=new i.a,t=!0,l=!1,o=void 0;try{for(var a,r=n()(this.roleResourceList);!(t=(a=r.next()).done);t=!0){var s=a.value;e.set(s.resId,!0)}}catch(e){l=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(l)throw o}}return e}},methods:{getRoleResourceListByRoleId:function(){var e=this;this.$Ajax.get(RoleResourceManagerUrl.get.roleResourceListByRoleId,{moduleId:this.moduleId,roleId:this.roleId}).success(!0,function(t){e.roleResourceList=t.rows})},searchResourceTreeListProcess:function(e){var t=this,l=[],o=this.hasResourceIdsMap;return e.forEach(function(e){e.children=e.children?e.children:[],e.leaf=!e.childCount||0===e.childCount.length,e.disabled=!e.status||e.status===t.dict.status.disabled||"NODE"!==e.type,e.checked=!!o.get(e.id),e.grantNodeChildLoading=!1,e.unGrantNodeChildLoading=!1,e.grantNodeAllChildLoading=!1,e.unGrantNodeAllChildLoading=!1,l.push(e)}),l},formatterResourceType:function(e,t,l,o){for(var i in this.dict.resourceTypes)if(this.dict.resourceTypes[i].value===l)return this.dict.resourceTypes[i].text;return"未知"},handleSizeChange:function(e){this.limit.pageSize=e,this.getResourcePageList()},handleCurrentChange:function(e){this.limit.currentPage=e,this.getResourcePageList()},getSearchResourceTreeList:function(){var e=this;this.searchResourceTreeLoading=!0,this.$Ajax.get(ResourceManagerUrl.get.rootResourceList,{moduleId:this.moduleId,searchText:this.searchResourceTree.searchTreeText}).success(!0,function(t){e.searchResourceTreeList=e.searchResourceTreeListProcess(t.rows)}).finally(function(){return e.searchResourceTreeLoading=!1})},handleLocationSearchResourceTree:function(e,t){e?this.$Ajax.get(ResourceManagerUrl.get.locationResourceList,{moduleId:this.moduleId,rootIds:this.searchResourceTreeRootIds.toString(),searchText:e}).success(!0,function(e){t(e.rows)}):t([])},handleSelectLocationSearchResource:function(e){this.searchLocationExpandIds=e.parentIds.substring(1).split("/"),this.expandSearchResourceNode()},expandSearchResourceNode:function(){var e=this.$refs.searchResourceTree.getNode(this.searchLocationExpandIds[0]);e&&(this.searchLocationExpandIds=this.searchLocationExpandIds.slice(1),!1===e.expanded?(e.expand(),this.expandSearchResourceNode()):this.expandSearchResourceNode())},getSearchResourceTreeChildNodeList:function(e,t){var l=this;this.$Ajax.get(ResourceManagerUrl.get.childResourceList,{moduleId:this.moduleId,parentId:e.data.id}).success(!0,function(o){var i=l.searchResourceTreeListProcess(o.rows);if(e.data.children=i,e.data.childCount=i.length,e.data.open=!0,t(i),l.searchLocationExpandIds&&l.searchLocationExpandIds.length>0){var a=l.$refs.searchResourceTree.getNode(l.searchLocationExpandIds[0]);l.searchLocationExpandIds=l.searchLocationExpandIds.slice(1),a&&!1===a.expanded&&a.expand()}if(l.newLocationExpandIds&&l.newLocationExpandIds.length>0){var n=l.$refs.newResourceTree.getNode(l.newLocationExpandIds[0]);l.newLocationExpandIds=l.newLocationExpandIds.slice(1),n&&!1===n.expanded&&n.expand()}})},handleCheckedSearchResourceTreeNode:function(e,t,l){var o=this;l?this.$Ajax.post(RoleResourceManagerUrl.post.grantResourceToRole,{moduleId:this.moduleId,roleId:this.roleId,resourceId:t.id}).success(!0,function(){t.checked=!0,o.hasResourceIdsMap.set(t.id,!0)}):this.$Ajax.post(RoleResourceManagerUrl.post.unGrantResourceToRole,{moduleId:this.moduleId,roleId:this.roleId,resourceId:t.id}).success(!0,function(){t.checked=!1,o.hasResourceIdsMap.delete(t.id)})},handleDblClickTreeNode:function(e,t){t.childCount>0&&(e.expanded?e.collapse():e.expand())},handleClickGrantResourcesInNodeToRole:function(e,t){var l=this;t.grantNodeChildLoading=!0,this.$Ajax.post(RoleResourceManagerUrl.post.grantResourcesInNodeToRole,{moduleId:this.moduleId,nodeId:t.id,roleId:this.roleId}).success(!0,function(e){t.children&&t.children.forEach(function(e){return e.checked=!0}),e.rows.forEach(function(e){l.hasResourceIdsMap.set(e,!0)})}).finally(function(){return t.grantNodeChildLoading=!1})},handleClickUnGrantResourcesInNodeToRole:function(e,t){var l=this;t.unGrantNodeChildLoading=!0,this.$Ajax.post(RoleResourceManagerUrl.post.unGrantResourcesInNodeToRole,{moduleId:this.moduleId,nodeId:t.id,roleId:this.roleId}).success(!0,function(e){t.children&&t.children.forEach(function(e){return e.checked=!1}),e.rows.forEach(function(e){l.hasResourceIdsMap.delete(e)})}).finally(function(){return t.unGrantNodeChildLoading=!1})},checkedChildNode:function(e){var t=!0,l=!1,o=void 0;try{for(var i,a=n()(e);!(t=(i=a.next()).done);t=!0){var r=i.value;r.checked=!0,r.children&&this.checkedChildNode(r.children)}}catch(e){l=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(l)throw o}}},handleClickGrantAllChildResourcesInNode:function(e,t){var l=this;t.grantNodeAllChildLoading=!0,this.$Ajax.post(RoleResourceManagerUrl.post.grantAllChildResourcesInNodeToRole,{moduleId:this.moduleId,nodeId:t.id,roleId:this.roleId}).success(!0,function(e){t.children&&l.checkedChildNode(t.children),e.rows.forEach(function(e){l.hasResourceIdsMap.set(e,!0)})}).finally(function(){return t.grantNodeAllChildLoading=!1})},unCheckedChildNode:function(e){var t=!0,l=!1,o=void 0;try{for(var i,a=n()(e);!(t=(i=a.next()).done);t=!0){var r=i.value;r.checked=!1,r.children&&this.unCheckedChildNode(r.children)}}catch(e){l=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(l)throw o}}},handleClickUnGrantAllChildResourcesInNode:function(e,t){var l=this;t.unGrantNodeAllChildLoading=!0,this.$Ajax.post(RoleResourceManagerUrl.post.unGrantAllChildResourcesInNodeToRole,{moduleId:this.moduleId,nodeId:t.id,roleId:this.roleId}).success(!0,function(e){t.children&&l.unCheckedChildNode(t.children),e.rows.forEach(function(e){l.hasResourceIdsMap.delete(e)})}).finally(function(){return t.unGrantNodeAllChildLoading=!1})}},created:function(){this.getRoleResourceListByRoleId()},mounted:function(){this.tableHeight=document.body.clientHeight-220}},p={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("div",{staticClass:"avalon-merlin-default-search-bar full avalon-merlin-a-scroll"},[l("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",clearable:"",placeholder:"请输入内容","prefix-icon":"el-icon-search"},model:{value:e.searchResourceTree.searchTreeText,callback:function(t){e.$set(e.searchResourceTree,"searchTreeText",t)},expression:"searchResourceTree.searchTreeText"}}),e._v(" "),l("span",{staticClass:"btn-p-left"},[l("el-button",{attrs:{type:"success",size:"small",loading:e.searchResourceTreeLoading},on:{click:e.getSearchResourceTreeList}},[e._v("根节点搜索")])],1)],1),e._v(" "),l("div",{staticStyle:{"margin-top":"15px"},style:{height:e.tableHeight+"px"}},[e.searchResourceTreeList.length>0?l("div",{staticClass:"list-tools avalon-merlin-hidden"},[l("div",{staticClass:"avalon-merlin-lfloat"},[l("el-tag",{attrs:{size:"small"}},[e._v("双击节点名称可以展开/收缩节点")])],1),e._v(" "),l("div",{staticClass:"avalon-merlin-lfloat",staticStyle:{"margin-left":"10px"}},[l("el-tag",{attrs:{size:"small"}},[e._v("点击鼠标右键开启快捷菜单(未实现)")])],1),e._v(" "),l("div",{staticClass:"avalon-merlin-lfloat",staticStyle:{"margin-left":"10px"}},[l("el-tag",{attrs:{size:"small"}},[e._v("勾选复选框启用资源")])],1)]):e._e(),e._v(" "),l("div",{staticClass:"tree-module",style:{top:e.treeTopNum+"px"}},[l("el-autocomplete",{directives:[{name:"show",rawName:"v-show",value:e.searchResourceTreeList.length>0,expression:"searchResourceTreeList.length > 0"}],staticStyle:{width:"40%"},attrs:{size:"small",placeholder:"资源定位",debounce:1e3,"value-key":"locationName","fetch-suggestions":e.handleLocationSearchResourceTree,"prefix-icon":"el-icon-search"},on:{select:e.handleSelectLocationSearchResource},model:{value:e.searchLocationResource,callback:function(t){e.searchLocationResource=t},expression:"searchLocationResource"}}),e._v(" "),l("div",{staticClass:"tree-module-inner avalon-merlin-v-scroll"},[l("el-tree",{ref:"searchResourceTree",attrs:{data:e.searchResourceTreeList,"highlight-current":!0,draggable:!0,"check-strictly":!0,lazy:"","expand-on-click-node":!1,props:{label:"name",isLeaf:"leaf"},load:e.getSearchResourceTreeChildNodeList,"node-key":"id","empty-text":"暂无资源"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,i=t.data;return l("span",{staticClass:"custom-tree-node"},[l("span",["NODE"!==i.type?l("el-checkbox",{attrs:{value:i.checked},on:{change:function(t){e.handleCheckedSearchResourceTreeNode(o,i,t)}}}):e._e(),e._v(" "),o.expanded||i.type!==e.dict.resourceType.node?o.expanded&&i.type===e.dict.resourceType.node?l("i",{staticClass:"we-icon-folder-open-o"}):i.type===e.dict.resourceType.url?l("i",{staticClass:"we-icon-link"}):i.type===e.dict.resourceType.permission?l("i",{staticClass:"we-icon-jurisdiction-shield"}):e._e():l("i",{staticClass:"we-icon-folder-o"}),e._v(" "),l("em",{on:{dblclick:function(t){e.handleDblClickTreeNode(o,i)}}},[e._v(e._s(o.label))])],1),e._v(" "),"NODE"===i.type&&i.childCount>0?l("span",[l("el-button",{staticStyle:{color:"#409eff"},attrs:{loading:i.grantNodeChildLoading,type:"text",size:"mini"},on:{click:function(t){t.stopPropagation(),e.handleClickGrantResourcesInNodeToRole(o,i)}}},[e._v("使用该节点下所有资源")]),e._v(" "),l("em",[e._v("/")]),e._v(" "),l("el-button",{staticStyle:{color:"#409eff"},attrs:{loading:i.unGrantNodeChildLoading,type:"text",size:"mini"},on:{click:function(t){t.stopPropagation(),e.handleClickUnGrantResourcesInNodeToRole(o,i)}}},[e._v("取消该节点下所有资源")]),e._v(" "),l("em",[e._v("    ")]),e._v(" "),l("el-button",{staticStyle:{color:"#f56c6c"},attrs:{loading:i.grantNodeAllChildLoading,type:"text",size:"mini"},on:{click:function(t){t.stopPropagation(),e.handleClickGrantAllChildResourcesInNode(o,i)}}},[e._v("使用该节点及所有子节点下所有资源")]),e._v(" "),l("em",[e._v("/")]),e._v(" "),l("el-button",{staticStyle:{color:"#f56c6c"},attrs:{loading:i.unGrantNodeAllChildLoading,type:"text",size:"mini"},on:{click:function(t){t.stopPropagation(),e.handleClickUnGrantAllChildResourcesInNode(o,i)}}},[e._v("取消该节点及所有子节点下所有资源")])],1):e._e()])}}])})],1)],1)])])},staticRenderFns:[]};var f=l("C7Lr")(h,p,!1,function(e){l("pFvh")},"data-v-5d7712b7",null);t.default=f.exports},w12C:function(e,t,l){"use strict";var o=l("VKnT").f,i=l("hX+v"),a=l("SFw5"),n=l("GEwK"),r=l("6Iqy"),s=l("EWZD"),d=l("sswn"),c=l("UFff"),u=l("//tU"),h=l("5D1g"),p=l("92Lf").fastKey,f=l("4qZx"),C=h?"_s":"size",m=function(e,t){var l,o=p(t);if("F"!==o)return e._i[o];for(l=e._f;l;l=l.n)if(l.k==t)return l};e.exports={getConstructor:function(e,t,l,d){var c=e(function(e,o){r(e,c,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[C]=0,void 0!=o&&s(o,l,e[d],e)});return a(c.prototype,{clear:function(){for(var e=f(this,t),l=e._i,o=e._f;o;o=o.n)o.r=!0,o.p&&(o.p=o.p.n=void 0),delete l[o.i];e._f=e._l=void 0,e[C]=0},delete:function(e){var l=f(this,t),o=m(l,e);if(o){var i=o.n,a=o.p;delete l._i[o.i],o.r=!0,a&&(a.n=i),i&&(i.p=a),l._f==o&&(l._f=i),l._l==o&&(l._l=a),l[C]--}return!!o},forEach:function(e){f(this,t);for(var l,o=n(e,arguments.length>1?arguments[1]:void 0,3);l=l?l.n:this._f;)for(o(l.v,l.k,this);l&&l.r;)l=l.p},has:function(e){return!!m(f(this,t),e)}}),h&&o(c.prototype,"size",{get:function(){return f(this,t)[C]}}),c},def:function(e,t,l){var o,i,a=m(e,t);return a?a.v=l:(e._l=a={i:i=p(t,!0),k:t,v:l,p:o=e._l,n:void 0,r:!1},e._f||(e._f=a),o&&(o.n=a),e[C]++,"F"!==i&&(e._i[i]=a)),e},getEntry:m,setStrong:function(e,t,l){d(e,t,function(e,l){this._t=f(e,t),this._k=l,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?c(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,c(1))},l?"entries":"values",!l,!0),u(t)}}}});