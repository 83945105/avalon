webpackJsonp([6],{"4qZx":function(t,e,r){var n=r("ih9o");t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},"6NZw":function(t,e){},BVbZ:function(t,e,r){r("uT9G")("Set")},CVdf:function(t,e,r){var n=r("GEwK"),s=r("bPMW"),i=r("6Ke0"),a=r("WA9S"),o=r("GO8T");t.exports=function(t,e){var r=1==t,l=2==t,u=3==t,c=4==t,d=6==t,f=5==t||d,h=e||o;return function(e,o,v){for(var g,p,m=i(e),_=s(m),x=n(o,v,3),y=a(_.length),b=0,w=r?h(e,y):l?h(e,0):void 0;y>b;b++)if((f||b in _)&&(p=x(g=_[b],b,m),t))if(r)w[b]=p;else if(p)switch(t){case 3:return!0;case 5:return g;case 6:return b;case 2:w.push(g)}else if(c)return!1;return d?-1:u||c?c:w}}},GO8T:function(t,e,r){var n=r("oeSC");t.exports=function(t,e){return new(n(t))(e)}},HzJ8:function(t,e,r){t.exports={default:r("UCoN"),__esModule:!0}},Kdj8:function(t,e,r){"use strict";var n=r("HH4H"),s=r("273z"),i=r("92Lf"),a=r("QzFD"),o=r("Rb18"),l=r("SFw5"),u=r("EWZD"),c=r("6Iqy"),d=r("ih9o"),f=r("bNZV"),h=r("VKnT").f,v=r("CVdf")(0),g=r("5D1g");t.exports=function(t,e,r,p,m,_){var x=n[t],y=x,b=m?"set":"add",w=y&&y.prototype,S={};return g&&"function"==typeof y&&(_||w.forEach&&!a(function(){(new y).entries().next()}))?(y=e(function(e,r){c(e,y,t,"_c"),e._c=new x,void 0!=r&&u(r,m,e[b],e)}),v("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in w&&(!_||"clear"!=t)&&o(y.prototype,t,function(r,n){if(c(this,y,t),!e&&_&&!d(r))return"get"==t&&void 0;var s=this._c[t](0===r?0:r,n);return e?this:s})}),_||h(y.prototype,"size",{get:function(){return this._c.size}})):(y=p.getConstructor(e,t,m,b),l(y.prototype,r),i.NEED=!0),f(y,t),S[t]=y,s(s.G+s.W+s.F,S),_||p.setStrong(y,t,m),y}},NnAP:function(t,e,r){var n=r("6Bon"),s=r("MGMR");t.exports=r("UB+n").getIterator=function(t){var e=s(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},"R+mD":function(t,e,r){var n=r("jUE6"),s=r("c5rS");t.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return s(this)}}},"T+nk":function(t,e,r){r("aUxz")("Set")},Tuag:function(t,e,r){var n=r("273z");n(n.P+n.R,"Set",{toJSON:r("R+mD")("Set")})},UCoN:function(t,e,r){r("xsjh"),r("zRHv"),t.exports=r("NnAP")},aUxz:function(t,e,r){"use strict";var n=r("273z"),s=r("HeGE"),i=r("GEwK"),a=r("EWZD");t.exports=function(t){n(n.S,t,{from:function(t){var e,r,n,o,l=arguments[1];return s(this),(e=void 0!==l)&&s(l),void 0==t?new this:(r=[],e?(n=0,o=i(l,arguments[2],2),a(t,!1,function(t){r.push(o(t,n++))})):a(t,!1,r.push,r),new this(r))}})}},c5rS:function(t,e,r){var n=r("EWZD");t.exports=function(t,e){var r=[];return n(t,!1,r.push,r,e),r}},d9Ip:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("kfHR"),s=r.n(n),i=r("zsLt"),a=r.n(i),o=r("HzJ8"),l=r.n(o),u=r("aA9S"),c=r.n(u),d={currentPage:1,pageCount:1,pageSize:10,total:0},f={name:"object-manage",mixins:[r("qSEq").b],props:{moduleId:{type:String,required:!0}},data:function(){return{userColumnList:[],searchUser:{searchText:""},tableSkeleton:!1,tableLoading:!1,userList:[],limit:c()({},d),roleList:[],checkedUserList:[]}},computed:{usableRoleList:function(){var t=[];for(var e in this.roleList)this.roleList[e].status===this.dict.status.normal&&t.push(this.roleList[e]);return t},unusableRoleList:function(){var t=[];for(var e in this.roleList)this.roleList[e].status===this.dict.status.disabled&&t.push(this.roleList[e]);return t},usableRoleIds:function(){var t=[];for(var e in this.roleList)this.roleList[e].status===this.dict.status.normal&&t.push(this.roleList[e].id);return t}},methods:{getUserColumnList:function(){var t=this;this.$Ajax.get(UserManagerUrl.get.userColumnList).success(!0,function(e){t.userColumnList=e.rows,t.getUserPageList()})},userListProcess:function(t){for(var e in t){for(var r in t[e])t[e][r+"-edit"]=!1,t[e][r+"-loading"]=!1,t[e][r+"-edit-value"]=t[e][r];t[e].ownerRoleIds=[],t[e].indeterminateRoles=!1,t[e].checkAllRoles=!1}return t},getRoleList:function(){var t=this;this.$Ajax.get(RoleManagerUrl.get.roleList,{moduleId:this.moduleId}).success(!0,function(e){t.roleList=e.rows})},reGetUserPageList:function(){c()(this.limit,d),this.getUserPageList()},getUserPageList:function(){var t=this;this.tableLoading=!0,this.$Ajax.get(UserManagerUrl.get.userPageList,{moduleId:this.moduleId,currentPage:this.limit.currentPage,pageSize:this.limit.pageSize,searchText:this.searchUser.searchText}).success(!0,function(e){t.tableSkeleton=!1,c()(t.limit,e.limit),t.userList=t.userListProcess(e.rows)}).notSuccess(function(){return t.tableSkeleton=500}).catch(function(){return t.tableSkeleton=500}).finally(function(){return t.tableLoading=!1})},handleExpandChange:function(t,e){var r=this;t.ownerRoleIds.length>0||this.$Ajax.get(RoleUserManagerUrl.get.roleUserListByUserId,[t.id],{params:{moduleId:this.moduleId}}).success(!0,function(e){t.ownerRoleIds=e.rows.map(function(e){t["role_"+e.roleId+"_status"]=r.dict.status.normal;var n=!0,s=!1,i=void 0;try{for(var a,o=l()(r.roleList);!(n=(a=o.next()).done);n=!0){a.value.id===e.roleId&&(t["role_"+e.roleId+"_status"]="OTHER"===e.type?r.dict.status.disabled:r.dict.status.normal)}}catch(t){s=!0,i=t}finally{try{!n&&o.return&&o.return()}finally{if(s)throw i}}return e.roleId}),t.ownerRoleIds.length>0&&(t.indeterminateRoles=!0);var n=void 0,s=!0,i=!1,a=void 0;try{for(var o,u=l()(r.usableRoleIds);!(s=(o=u.next()).done);s=!0){var c=o.value;n=!1;var d=!0,f=!1,h=void 0;try{for(var v,g=l()(t.ownerRoleIds);!(d=(v=g.next()).done);d=!0){if(c===v.value){n=!0;break}}}catch(t){f=!0,h=t}finally{try{!d&&g.return&&g.return()}finally{if(f)throw h}}if(!n)return}}catch(t){i=!0,a=t}finally{try{!s&&u.return&&u.return()}finally{if(i)throw a}}t.checkAllRoles=!0})},handleSelectionChange:function(t){this.checkedUserList=t},handleSizeChange:function(t){this.limit.pageSize=t,this.getUserPageList()},handleCurrentChange:function(t){this.limit.currentPage=t,this.getUserPageList()},handleChangeUserStatus:function(t){var e=this;this.$Ajax.put(UserManagerUrl.put.userStatus,t,{params:{moduleId:this.moduleId}}).success({message:"切换状态成功"}).notSuccess(function(){t.status===e.dict.status.normal?t.status=e.dict.status.disabled:t.status=e.dict.status.normal})},handleCheckAllRoles:function(t,e){var r=this,n=[],i=new a.a;if(t){var o=!0,u=!1,c=void 0;try{for(var d,f=l()(this.usableRoleList);!(o=(d=f.next()).done);o=!0){var h=d.value;i.add(h.id),e["role_"+h.id+"_status"]!==this.dict.status.disabled&&n.push(h.id)}}catch(t){u=!0,c=t}finally{try{!o&&f.return&&f.return()}finally{if(u)throw c}}this.$Ajax.post(RoleUserManagerUrl.post.grantRolesToUsers,{userIds:[e.id].toString(),roleIds:n.toString(),moduleId:this.moduleId}).success("设置角色成功",function(){var t=!0,n=!1,a=void 0;try{for(var o,u=l()(e.ownerRoleIds);!(t=(o=u.next()).done);t=!0){var c=o.value;i.add(c)}}catch(t){n=!0,a=t}finally{try{!t&&u.return&&u.return()}finally{if(n)throw a}}var d=!0,f=!1,h=void 0;try{for(var v,g=l()(r.usableRoleList);!(d=(v=g.next()).done);d=!0){var p=v.value;i.add(p.id)}}catch(t){f=!0,h=t}finally{try{!d&&g.return&&g.return()}finally{if(f)throw h}}e.ownerRoleIds=s()(i),e.indeterminateRoles=!1})}else this.$Ajax.post(RoleUserManagerUrl.post.unGrantRolesToUsers,{userIds:[e.id].toString(),roleIds:n.toString(),moduleId:this.moduleId}).success("取消角色成功",function(){var t=new a.a,n=!0,i=!1,o=void 0;try{for(var u,c=l()(e.ownerRoleIds);!(n=(u=c.next()).done);n=!0){var d=u.value,f=!0,h=!1,v=void 0;try{for(var g,p=l()(r.unusableRoleList);!(f=(g=p.next()).done);f=!0){if(g.value.id===d){t.add(d);break}}}catch(t){h=!0,v=t}finally{try{!f&&p.return&&p.return()}finally{if(h)throw v}}e["role_"+d+"_status"]===r.dict.status.disabled&&t.add(d)}}catch(t){i=!0,o=t}finally{try{!n&&c.return&&c.return()}finally{if(i)throw o}}e.ownerRoleIds=s()(t),e.indeterminateRoles=e.ownerRoleIds.length>0})},handleCheckRoleChange:function(t,e,r){t?this.$Ajax.post(RoleUserManagerUrl.post.grantRoleToUser,{userId:e.id,roleId:r.id,moduleId:this.moduleId}).success("设置角色成功"):this.$Ajax.post(RoleUserManagerUrl.post.unGrantRoleToUser,{userId:e.id,roleId:r.id,moduleId:this.moduleId}).success("取消角色成功")}},created:function(){this.getUserColumnList(),this.getRoleList()}},h={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"gar-search-bar"},[r("ul",{staticClass:"gar-search-bar-list"},[r("li",[r("em",{staticClass:"list-left"},[t._v("关键字：")]),t._v(" "),r("div",{staticClass:"list-right common-w-large"},[r("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入内容"},model:{value:t.searchUser.searchText,callback:function(e){t.$set(t.searchUser,"searchText",e)},expression:"searchUser.searchText"}})],1)]),t._v(" "),r("li",{staticClass:"spacing"},[r("we-button",{attrs:{loading:t.tableLoading,clearable:"",size:"small"},on:{click:t.reGetUserPageList}},[t._v("查询\n        ")])],1)]),t._v(" "),r("div",{staticClass:"common-clear"})]),t._v(" "),r("div",{staticClass:"gar-list-main",staticStyle:{top:"62px"}},[r("we-skeleton",{attrs:{animation:"","paragraph-rows":10,"paragraph-width":"100%"},on:{reload:t.getUserPageList},model:{value:t.tableSkeleton,callback:function(e){t.tableSkeleton=e},expression:"tableSkeleton"}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading&&!1===t.tableSkeleton,expression:"tableLoading && tableSkeleton===false"}],staticClass:"gar-list-main-inner",staticStyle:{bottom:"62px"}},[r("el-table",{staticStyle:{overflow:"inherit"},attrs:{data:t.userList,stripe:"",height:"100%"},on:{"expand-change":t.handleExpandChange,"selection-change":t.handleSelectionChange}},[t.roleList&&t.roleList.length>0?r("el-table-column",{attrs:{type:"expand",label:"拥有角色列表",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-checkbox",{staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{indeterminate:e.row.indeterminateRoles},on:{change:function(r){t.handleCheckAllRoles(r,e.row)}},model:{value:e.row.checkAllRoles,callback:function(r){t.$set(e.row,"checkAllRoles",r)},expression:"scope.row.checkAllRoles"}},[t._v("全选\n              ")]),t._v(" "),r("el-tag",{staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"small"}},[t._v("点击按钮可以给该当前行用户授予或取消角色")]),t._v(" "),r("el-tag",{staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"small"}},[t._v("绿色背景的角色来源于其它服务")]),t._v(" "),r("el-tag",{attrs:{size:"small"}},[t._v("若该用户在其它服务拥有某个角色,则无法取消")]),t._v(" "),r("el-checkbox-group",{attrs:{size:"small"},model:{value:e.row.ownerRoleIds,callback:function(r){t.$set(e.row,"ownerRoleIds",r)},expression:"scope.row.ownerRoleIds"}},[t._l(t.roleList,function(n){return[r("el-checkbox",{staticStyle:{"margin-left":"10px","margin-bottom":"10px"},style:{backgroundColor:n.type===t.dict.roleType.local?void 0:"#67c23a66"},attrs:{label:n.id,title:n.role,disabled:n.status===t.dict.status.disabled||e.row["role_"+n.id+"_status"]===t.dict.status.disabled,border:""},on:{change:function(r){t.handleCheckRoleChange(r,e.row,n)}}},[t._v(t._s(n.name)+"\n                  ")])]})],2)]}}])}):t._e(),t._v(" "),t._l(t.userColumnList,function(t,e){return[r("el-table-column",{attrs:{label:t.label,"column-key":t.columnKey,prop:t.columnKey,"min-width":35,align:t.align}})]}),t._v(" "),r("el-table-column",{attrs:{label:"状态","min-width":15,align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-switch",{attrs:{"active-text":"禁用","inactive-text":"取消","active-value":t.dict.status.disabled,"inactive-value":t.dict.status.normal,"active-color":"#13ce66","inactive-color":"#cccccc"},on:{change:function(r){t.handleChangeUserStatus(e.row)}},model:{value:e.row.status,callback:function(r){t.$set(e.row,"status",r)},expression:"scope.row.status"}})]}}])})],2)],1)])],1),t._v(" "),r("div",{staticClass:"gar-list-main-paging gar-paging"},[r("el-pagination",{attrs:{"current-page":t.limit.currentPage,"page-sizes":[10,50,100,200,300,400],"page-size":t.limit.pageSize,total:t.limit.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])},staticRenderFns:[]};var v=r("C7Lr")(f,h,!1,function(t){r("6NZw")},"data-v-7d50af62",null);e.default=v.exports},edtE:function(t,e,r){"use strict";var n=r("w12C"),s=r("4qZx");t.exports=r("Kdj8")("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(s(this,"Set"),t=0===t?0:t,t)}},n)},ntuF:function(t,e,r){r("VE3R"),r("zRHv"),r("xsjh"),r("edtE"),r("Tuag"),r("BVbZ"),r("T+nk"),t.exports=r("UB+n").Set},oeSC:function(t,e,r){var n=r("ih9o"),s=r("f5Gq"),i=r("mhb3")("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),n(e)&&null===(e=e[i])&&(e=void 0)),void 0===e?Array:e}},uT9G:function(t,e,r){"use strict";var n=r("273z");t.exports=function(t){n(n.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},w12C:function(t,e,r){"use strict";var n=r("VKnT").f,s=r("hX+v"),i=r("SFw5"),a=r("GEwK"),o=r("6Iqy"),l=r("EWZD"),u=r("sswn"),c=r("UFff"),d=r("//tU"),f=r("5D1g"),h=r("92Lf").fastKey,v=r("4qZx"),g=f?"_s":"size",p=function(t,e){var r,n=h(e);if("F"!==n)return t._i[n];for(r=t._f;r;r=r.n)if(r.k==e)return r};t.exports={getConstructor:function(t,e,r,u){var c=t(function(t,n){o(t,c,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[g]=0,void 0!=n&&l(n,r,t[u],t)});return i(c.prototype,{clear:function(){for(var t=v(this,e),r=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];t._f=t._l=void 0,t[g]=0},delete:function(t){var r=v(this,e),n=p(r,t);if(n){var s=n.n,i=n.p;delete r._i[n.i],n.r=!0,i&&(i.n=s),s&&(s.p=i),r._f==n&&(r._f=s),r._l==n&&(r._l=i),r[g]--}return!!n},forEach:function(t){v(this,e);for(var r,n=a(t,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(t){return!!p(v(this,e),t)}}),f&&n(c.prototype,"size",{get:function(){return v(this,e)[g]}}),c},def:function(t,e,r){var n,s,i=p(t,e);return i?i.v=r:(t._l=i={i:s=h(e,!0),k:e,v:r,p:n=t._l,n:void 0,r:!1},t._f||(t._f=i),n&&(n.n=i),t[g]++,"F"!==s&&(t._i[s]=i)),t},getEntry:p,setStrong:function(t,e,r){u(t,e,function(t,r){this._t=v(t,e),this._k=r,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?c(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,c(1))},r?"entries":"values",!r,!0),d(e)}}},zsLt:function(t,e,r){t.exports={default:r("ntuF"),__esModule:!0}}});