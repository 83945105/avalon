webpackJsonp([25],{"0Eir":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("qSEq"),n=r("3TTE"),o=r("13vy"),c=r("ELdc"),a={likeText:""},i={name:"resource-tree",mixins:[s.b,n.a],props:{moduleId:{type:String,required:!0},queryParams:Object,queryChildParams:Object},data:function(){return{params:Object(c.a)({},a),treeAsyncProps:{label:"name",isLeaf:"leaf",children:"children",disabled:"disabled"},treeAsyncNodeKey:"id"}},methods:{append:function(e,t){if(t){e=this.formatterTreeAsyncRow(e,{formatterRow:function(e){return e.expanded=!1},formatterNodeIsLeaf:function(e){return 0===e.childCount}});var r=this.$refs[this.treeAsyncRef];r.append(e,r.getNode(t))}},insertAfterRoot:function(e){e=this.formatterTreeAsyncRow(e,{formatterRow:function(e){return e.expanded=!1},formatterNodeIsLeaf:function(e){return 0===e.childCount}});var t=this.$refs[this.treeAsyncRef];t.insertAfter(e,t.getNode(this.treeAsyncRows[this.treeAsyncRows.length-1]))},getCheckedNodes:function(e,t){return this.$refs[this.treeAsyncRef].getCheckedNodes(e,t)},getCheckedKeys:function(e){return this.$refs[this.treeAsyncRef].getCheckedKeys(e)},getTreeAsyncRows:function(){var e=this;this.$emit("check",{},{checkedNodes:[],checkedKeys:[],halfCheckedKeys:[],halfCheckedNodes:[]},this),this.treeAsyncLoading=!0;var t=Object(c.a)({moduleId:this.moduleId},this.params);this.queryParams&&Object(c.a)(t,this.queryParams),this.$Ajax.get(o.a.get.listRootResource,t).success(!0,function(t){e.treeAsyncSkeleton=!1,e.$nextTick(function(){e.treeAsyncRows=e.formatterTreeAsyncRows(t.rows,{formatterRow:function(e){return e.expanded=!1},formatterNodeIsLeaf:function(e){return 0===e.childCount}})})}).notSuccess(function(){return e.treeAsyncSkeleton=500}).catch(function(){return e.treeAsyncSkeleton=500}).finally(function(){return e.treeAsyncLoading=!1})},getTreeAsyncNodes:function(e,t){var r=this,s={moduleId:this.moduleId};this.queryChildParams&&Object(c.a)(s,this.queryChildParams),e.level>=1&&this.$Ajax.get(o.a.get.listResourceByParentId,[e.data.id],{params:s}).success(!0,function(e){var s=r.formatterTreeAsyncRows(e.rows,{formatterRow:function(e){return e.expanded=!1},formatterNodeIsLeaf:function(e){return 0===e.childCount}});t(s)})},handleCheckTreeAsyncNode:function(e,t){this.$emit("check",e,t,this)},handleDblClickTreeAsyncNode:function(e){var t=e.node;e.data.childCount>0&&(t.expanded?t.collapse():t.expand())}},created:function(){this.getTreeAsyncRows()}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",[r("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",clearable:"",placeholder:"请输入内容","prefix-icon":"el-icon-search"},model:{value:e.params.likeText,callback:function(t){e.$set(e.params,"likeText",t)},expression:"params.likeText"}}),e._v(" "),r("span",{staticClass:"btn-p-left"},[r("el-button",{attrs:{type:"success",size:"small",loading:e.treeAsyncLoading},on:{click:e.getTreeAsyncRows}},[e._v("根节点搜索")])],1)],1),e._v(" "),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.treeAsyncLoading&&!1===e.treeAsyncSkeleton,expression:"treeAsyncLoading && treeAsyncSkeleton === false"}],staticClass:"tree-module-default text-selection",staticStyle:{width:"480px","margin-top":"5px"}},[r("el-autocomplete",{staticStyle:{width:"50%"},attrs:{disabled:"",size:"small",placeholder:"定位资源",debounce:1e3,"value-key":"locationName","prefix-icon":"el-icon-search"}}),e._v(" "),r("we-skeleton",{attrs:{animation:"","paragraph-rows":8},on:{reload:e.getTreeAsyncRows},model:{value:e.treeAsyncSkeleton,callback:function(t){e.treeAsyncSkeleton=t},expression:"treeAsyncSkeleton"}},[r("el-tree",{ref:e.treeAsyncRef,attrs:{data:e.treeAsyncRows,props:e.treeAsyncProps,"node-key":e.treeAsyncNodeKey,lazy:!0,load:e.getTreeAsyncNodes,"expand-on-click-node":!1,"check-strictly":!0,"show-checkbox":"","empty-text":"暂无资源","highlight-current":""},on:{check:e.handleCheckTreeAsyncNode},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node,n=t.data;return r("span",{},[s.expanded||n.type!==e.dict.resourceTypeValue.NODE?s.expanded&&n.type===e.dict.resourceTypeValue.NODE?r("i",{staticClass:"we-icon-folder-open-o"}):n.type===e.dict.resourceTypeValue.URL?r("i",{staticClass:"we-icon-link"}):n.type===e.dict.resourceTypeValue.PERMISSION?r("i",{staticClass:"we-icon-jurisdiction-shield"}):e._e():r("i",{staticClass:"we-icon-folder-o"}),e._v(" "),r("span",{on:{dblclick:function(t){e.handleDblClickTreeAsyncNode({node:s,data:n})}}},[e._v(e._s(s.label))])])}}])})],1)],1)])},staticRenderFns:[]};var l=r("C7Lr")(i,d,!1,function(e){r("BZEc")},"data-v-2c5673fc",null);t.default=l.exports},"13vy":function(e,t,r){"use strict";var s=r("Nj3f"),n={get:{listResource:s.a+"/api-gar-resource/get/list/resource",pageListResource:s.a+"/api-gar-resource/get/pageList/resource",listRootResource:s.a+"/api-gar-resource/get/list/rootResource",pageListRootResource:s.a+"/api-gar-resource/get/pageList/rootResource",listResourceByParentId:s.a+"/api-gar-resource/get/list/resourceByParentId/{parentId}",listResourceIdAndNameByResourceIds:s.a+"/api-gar-resource/get/list/resourceIdAndNameByResourceIds/{resourceIds}"},post:{resource:s.a+"/api-gar-resource/post/resource"},put:{resourceByResourceId:s.a+"/api-gar-resource/put/resourceByResourceId/{resourceId}"},delete:{resourceByResourceId:s.a+"/api-gar-resource/delete/resourceByResourceId/{resourceId}",listResourceByResourceIds:s.a+"/api-gar-resource/delete/list/resourceByResourceIds/{resourceIds}"}};t.a=n},"3TTE":function(e,t,r){"use strict";t.a={data:function(){return{treeAsyncProps:{label:"name",isLeaf:"leaf",children:"children",disabled:"disabled"},treeAsyncNodeKey:"id",treeAsyncRef:"treeAsync",treeAsyncSkeleton:!0,treeAsyncLoading:!1,treeAsyncRows:[],treeAsyncNodeDeleteLoading$:"delete_loading$",treeAsyncShowAdd:!1,treeAsyncAddLoading:!1,treeAsyncShowEdit:!1,treeAsyncEditLoading:!1,treeAsyncSelectedNode:{},treeAsyncSelectedNodeData:{},treeAsyncAutoExpandKeys:[]}},methods:{formatterTreeAsyncRow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.formatterRow,s=t.formatterNodeIsLeaf,n=t.formatterNodeChildren;return e[this.treeAsyncNodeDeleteLoading$]=!1,r&&r(e),e[this.treeAsyncProps.isLeaf]=!s||s(e),e[this.treeAsyncProps.children]=n?n(e):[],e},formatterTreeAsyncRows:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.formatterRow,n=r.formatterNodeIsLeaf;return e.forEach(function(e){return t.formatterTreeAsyncRow(e,{formatterRow:s,formatterNodeIsLeaf:n})}),e},findRow:function(e,t){if(e&&0!==e.length&&t){var r=void 0;for(var s in e){if(""+e[s][this.treeAsyncNodeKey]==""+t)return e[s];if(r=this.findRow(e[s][this.treeAsyncProps.children],t))return r}}},isTreeAsyncRowHasChildren:function(e){return e[this.treeAsyncProps.children]&&e[this.treeAsyncProps.children].length>0},setTreeAsyncRowChildren:function(e,t){t&&(e[this.treeAsyncProps.children]=t)},addTreeAsyncRowChild:function(e,t){t&&(e[this.treeAsyncProps.children]||this.$set(e,this.treeAsyncProps.children,[]),e[this.treeAsyncProps.children].push(t))},expandTreeNodeByKeys:function(e){var t=e.key;this.$refs[this.treeAsyncRef].store.nodesMap[t].expand()}}}},BZEc:function(e,t){}});